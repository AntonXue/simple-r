module Main where

import Lib
import System.Environment


main :: IO ()
main = do
  args <- getArgs
  _ <- case args of
    ("--parse" : dir : []) -> parseFile dir
    ("--run" : file : []) -> runFile file
    ("--test-parse" : []) -> testParse
    _ -> putStrLn "main: unrecognized command"
  -- prog <- parseRFile $ head args
  -- putStrLn $ show prog
  -- state <- loadFileGuessWithBase $ head args
  -- putStrLn $ ppState state

  putStrLn "main: done!"

runFile :: String -> IO ()
runFile file = do
  -- state <- loadFileGuessWithBase $ file
  state <- loadFileGuess $ file
  let redAcc = runN 100 state
  -- putStrLn $ ppHist ([], state)
  -- putStrLn $ show $ length $ compAcc acc
  putStrLn $ ppRedAccum redAcc
  putStrLn $ show $ getValuesRed redAcc


parseFile :: String -> IO ()
parseFile dir = do
  _ <- testPassesOnDir dir
  putStrLn "parseFile: done!"




testStr =
      "[RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"ggplot\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVecSub (RVar (RIdent {ridPkg = Nothing, ridName = \"res2\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RBinOp (REq) (RVecProj (RVar (RIdent {ridPkg = Nothing, ridName = \"res2\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"par\", ridSrc = Nothing, ridAnnot = Nothing}))]) (RConst (RStrConst (RString \"rho\"))))]),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"aes\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"x\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"alpha1_mean\", ridSrc = Nothing, ridAnnot = Nothing})),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"y\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"dfval_mean\", ridSrc = Nothing, ridAnnot = Nothing}))])]) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"geom_point\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"aes\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"size\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"val\", ridSrc = Nothing, ridAnnot = Nothing})),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"shape\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"nt\", ridSrc = Nothing, ridAnnot = Nothing}))])])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"geom_hline\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"yintercept\", ridSrc = Nothing, ridAnnot = Nothing}) (RUnOp (RUMinus) (RConst (RNumConst (RNumFloat 2.88))))])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"geom_errorbar\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"aes\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"ymin\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"dfval_qlo\", ridSrc = Nothing, ridAnnot = Nothing})),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"ymax\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"dfval_qhi\", ridSrc = Nothing, ridAnnot = Nothing}))])])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"theme_classic\", ridSrc = Nothing, ridAnnot = Nothing})) [])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"theme\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"panel.border\", ridSrc = Nothing, ridAnnot = Nothing}) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"element_rect\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"fill\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RNaConst))])])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"xlab\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"Mean value of ECM parameter\")))])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"ylab\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"Mean value and 95% intervals for DF test statistic\")))])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"scale_shape_discrete\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"name\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RStrConst (RString \"Number of\\nTime Points\")))])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"scale_size_continuous\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"name\", ridSrc = Nothing, ridAnnot = Nothing}) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"expression\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"paste\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"\\u03C1\"))),RExprArg (RConst (RStrConst (RString \" Value\")))])]),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"breaks\", ridSrc = Nothing, ridAnnot = Nothing}) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"seq\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RNumConst (RNumInt 0))),RExprArg (RConst (RNumConst (RNumFloat 0.9))),RExprArg (RConst (RNumConst (RNumFloat 0.1)))])])]"

        


testStr5 =
      "[RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"%>%\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"%>%\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"%>%\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"res\", ridSrc = Nothing, ridAnnot = Nothing})),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"group_by\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"par\", ridSrc = Nothing, ridAnnot = Nothing})),RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"val\", ridSrc = Nothing, ridAnnot = Nothing})),RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"nt\", ridSrc = Nothing, ridAnnot = Nothing}))])]),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"summarize\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"mean\", ridSrc = Nothing, ridAnnot = Nothing}) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"mean\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"false_positive\", ridSrc = Nothing, ridAnnot = Nothing}))])])]),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"ggplot\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"aes\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"y\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"val\", ridSrc = Nothing, ridAnnot = Nothing})),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"x\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"nt\", ridSrc = Nothing, ridAnnot = Nothing})),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"fill\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"mean\", ridSrc = Nothing, ridAnnot = Nothing}))])])]) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"geom_tile\", ridSrc = Nothing, ridAnnot = Nothing})) [])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"geom_text\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"aes\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"label\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"mean\", ridSrc = Nothing, ridAnnot = Nothing}))])])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"facet_wrap\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RUnOp (RUForm) (RVar (RIdent {ridPkg = Nothing, ridName = \"par\", ridSrc = Nothing, ridAnnot = Nothing}))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"labeller\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"label_parsed\", ridSrc = Nothing, ridAnnot = Nothing}))])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"theme_classic\", ridSrc = Nothing, ridAnnot = Nothing})) [])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"theme\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"panel.border\", ridSrc = Nothing, ridAnnot = Nothing}) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"element_rect\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"fill\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RNaConst))])])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"xlab\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"Number of Time Points\")))])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"ylab\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"expression\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"paste\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"Value of \\u03C1 / \"))),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"italic\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"d\")))])])])])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"scale_fill_gradient2\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"limits\", ridSrc = Nothing, ridAnnot = Nothing}) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"c\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RNumConst (RNumInt 0))),RExprArg (RConst (RNumConst (RNumFloat 0.5)))]),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"low\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RStrConst (RString \"white\"))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"high\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RStrConst (RString \"grey40\"))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"name\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RStrConst (RString \"Proportion of\\nFalse Positives\")))])) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"ggsave\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"fig1c.png\"))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"height\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RNumConst (RNumInt 5))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"width\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RNumConst (RNumInt 7))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"dpi\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RNumConst (RNumInt 300)))])]"




testStr5b =
  "[RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus) (RBinOp (RPlus)"
    ++
    -- "(RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"%>%\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"%>%\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"%>%\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"res\", ridSrc = Nothing, ridAnnot = Nothing})),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"group_by\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"par\", ridSrc = Nothing, ridAnnot = Nothing})),RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"val\", ridSrc = Nothing, ridAnnot = Nothing})),RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"nt\", ridSrc = Nothing, ridAnnot = Nothing}))])]),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"summarize\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"mean\", ridSrc = Nothing, ridAnnot = Nothing}) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"mean\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"false_positive\", ridSrc = Nothing, ridAnnot = Nothing}))])])]),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"ggplot\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"aes\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"y\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"val\", ridSrc = Nothing, ridAnnot = Nothing})),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"x\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"nt\", ridSrc = Nothing, ridAnnot = Nothing})),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"fill\", ridSrc = Nothing, ridAnnot = Nothing}) (RVar (RIdent {ridPkg = Nothing, ridName = \"mean\", ridSrc = Nothing, ridAnnot = Nothing}))])])])"
    "(RNull)"
    ++
    "(RNull))"
    ++
    "(RNull))"
    ++
    "(RNull))"
    ++
    "(RNull))"
    ++
    "(RNull))"
    ++
    "(RNull))"
    ++
  
    -- "(RNull))"
  "(RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"ylab\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"expression\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"paste\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"Value of \\u03C1 / \"))),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"italic\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"d\")))])])])]))"
  ++
  "(RNull))"
  -- "(RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"scale_fill_gradient2\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"limits\", ridSrc = Nothing, ridAnnot = Nothing}) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"c\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RNumConst (RNumInt 0))),RExprArg (RConst (RNumConst (RNumFloat 0.5)))]),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"low\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RStrConst (RString \"white\"))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"high\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RStrConst (RString \"grey40\"))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"name\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RStrConst (RString \"Proportion of\\nFalse Positives\")))]))"
  ++
  "(RNull)]"
  -- "(RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"ggsave\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"fig1c.png\"))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"height\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RNumConst (RNumInt 5))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"width\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RNumConst (RNumInt 7))),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"dpi\", ridSrc = Nothing, ridAnnot = Nothing}) (RConst (RNumConst (RNumInt 300)))])]"


  -- " RNull) RNull) RNull]"


testStr6 =
      
      "[RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"%>%\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"%>%\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"%>%\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"res\", ridSrc = Nothing, ridAnnot = Nothing})),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"filter\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RBinOp (REq) (RVar (RIdent {ridPkg = Nothing, ridName = \"nt\", ridSrc = Nothing, ridAnnot = Nothing})) (RConst (RNumConst (RNumInt 50))))])]),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"group_by\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"par\", ridSrc = Nothing, ridAnnot = Nothing})),RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"val\", ridSrc = Nothing, ridAnnot = Nothing})),RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"nt\", ridSrc = Nothing, ridAnnot = Nothing}))])]),RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"summarize\", ridSrc = Nothing, ridAnnot = Nothing})) [RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"mean_alpha\", ridSrc = Nothing, ridAnnot = Nothing}) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"mean\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"alpha1\", ridSrc = Nothing, ridAnnot = Nothing}))]),RIdentAssign (RIdent {ridPkg = Nothing, ridName = \"df_falseneg\", ridSrc = Nothing, ridAnnot = Nothing}) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"mean\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RBinOp (RGe) (RVar (RIdent {ridPkg = Nothing, ridName = \"dfval\", ridSrc = Nothing, ridAnnot = Nothing})) (RUnOp (RUMinus) (RConst (RNumConst (RNumFloat 2.93)))))])])],RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"mean\", ridSrc = Nothing, ridAnnot = Nothing}))[RExprArg (RBinOp (RGe) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"replicate\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RNumConst (RNumInt 1000))),RExprArg (RVecProj (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"adf.test\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"rnorm\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RNumConst (RNumInt 50)))])]) [RExprArg (RVar (RIdent {ridPkg = Nothing, ridName = \"statistic\", ridSrc = Nothing, ridAnnot = Nothing}))])]) (RUnOp (RUMinus) (RConst (RNumConst (RNumFloat 2.93)))))],RBinOp (RAssign) (RVar (RIdent {ridPkg = Nothing, ridName = \"stock\", ridSrc = Nothing, ridAnnot = Nothing})) (RFunCall (RVar (RIdent {ridPkg = Nothing, ridName = \"read.dta\", ridSrc = Nothing, ridAnnot = Nothing})) [RExprArg (RConst (RStrConst (RString \"stock2011.dta\")))])]"



testParse :: IO ()
testParse = do
  let rexprs = read testStr5b :: [RExpr]
  _ <- mapM (putStrLn . show) rexprs
  putStrLn "testParse: done!"

